services:
  # 1. Service Backend
  backend:
    build: ./server
    container_name: cbt-backend
    ports:
      - "8080:8080"
    # ðŸ‘‡ INI KUNCINYA: Baca semua rahasia (Redis, Neon, Gemini, JWT) dari file .env
    env_file:
      - ./server/.env
    environment:
      - PORT=8080
      # Kita HAPUS override REDIS_URL & DATABASE_URL di sini.
      # Biarkan dia pakai nilai asli yang ada di dalam file .env
    networks:
      - cbt-network

  # 2. Service Frontend
  frontend:
    build: ./client
    container_name: cbt-frontend
    ports:
      - "3000:8080"
    depends_on:
      - backend
    networks:
      - cbt-network

networks:
  cbt-network:
    driver: bridge
